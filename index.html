<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Đại hội Đoàn cơ sở Trung tâm 386 | Nhiệm kỳ 2025 - 2030</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="hero" id="top">
    <div class="hero__overlay"></div>
    <div class="hero__content container">
      <div class="hero__logos">
        <img src="assets/images/doan-logo.svg" alt="Logo Đoàn TNCS Hồ Chí Minh" class="hero__logo">
        <p class="hero__subtitle">ĐẠI HỘI ĐOÀN CƠ SỞ TRUNG TÂM 386</p>
        <h1 class="hero__title">Nhiệm kỳ 2025-2030</h1>
      </div>
      <p class="hero__description">
        Không gian số dành cho đoàn viên truy cập văn kiện và đóng góp ý kiến vào các văn kiện Đại hội.
      </p>
      <div class="hero__actions">
        <a class="button button--primary" href="#documents">Xem văn kiện</a>
        <a class="button button--outline" href="#feedback">Đóng góp ý kiến</a>
      </div>
    </div>
  </header>

  <main>
    <section id="about" class="section section--light">
      <div class="container">
        <div class="about__grid">
          <div>
            <h2 class="about__motto">Tuổi trẻ Trung tâm 386 "Đoàn kết - Khát vọng - Xung kích - Đổi mới - Phát triển"</h2>
            <p>
              Đại hội Đoàn cơ sở Trung tâm 386 nhiệm kỳ 2025 - 2030 hướng tới xây dựng tập thể đoàn viên giàu nhiệt huyết,
              tiên phong đổi mới, đoàn kết và sáng tạo. Trang thông tin này hỗ trợ đoàn viên truy cập nhanh các văn kiện,
              đồng thời tiếp nhận những kiến nghị, đề xuất quý báu cho văn kiện Đại hội.
            </p>
          </div>
          <div class="about__highlight">
            <img src="assets/images/doan-logo.svg" alt="Biểu trưng Đoàn" class="about__logo">
            <p>
              Màu xanh thanh niên là gam màu chủ đạo, thể hiện tinh thần xung kích, khát vọng vươn lên và quyết tâm đồng hành
              cùng sự phát triển của Trung tâm 386 trong giai đoạn mới.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="documents" class="section">
      <div class="container">
        <div class="section__header">
          <div>
            <span class="section__eyebrow">Văn kiện Đại hội</span>
            <h2>Kho tư liệu phục vụ đoàn viên</h2>
          </div>
          <p class="section__intro">
            Danh mục 5 văn kiện trọng tâm được cập nhật phục vụ nghiên cứu, sinh hoạt chi đoàn và công tác tuyên truyền trước Đại hội.
          </p>
        </div>
        <div class="documents" aria-live="polite">
          <ul class="documents__grid" role="list">
            <li class="documents__item" role="listitem">
              <a class="document-card" href="assets/documents/chuong-trinh-dai-hoi.pdf" target="_blank" rel="noopener" data-pdf="assets/documents/chuong-trinh-dai-hoi.pdf">
                <span class="document-card__icon" aria-hidden="true">
                  <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                    <path d="M12 6h28l12 12v40H12z" fill="#e2f1ff" stroke="#0b65c2" stroke-width="2" stroke-linejoin="round" />
                    <path d="M40 6v12h12" fill="#c5e3ff" />
                    <rect x="18" y="30" width="28" height="16" fill="#0b65c2" rx="2" />
                    <path d="M22 38l6 4 12-8" fill="none" stroke="#ffffff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </span>
                <span class="document-card__title">Chương trình Đại hội</span>
              </a>
            </li>
            <li class="documents__item" role="listitem">
              <a class="document-card" href="assets/documents/du-thao-bao-cao-chinh-tri-doan-tncs-xiii.pdf" target="_blank" rel="noopener" data-pdf="assets/documents/du-thao-bao-cao-chinh-tri-doan-tncs-xiii.pdf">
                <span class="document-card__icon" aria-hidden="true">
                  <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                    <path d="M12 6h28l12 12v40H12z" fill="#e2f1ff" stroke="#0b65c2" stroke-width="2" stroke-linejoin="round" />
                    <path d="M40 6v12h12" fill="#c5e3ff" />
                    <path d="M20 44h24" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" />
                    <rect x="20" y="30" width="24" height="10" fill="#0b65c2" rx="2" />
                    <path d="M24 34h16" stroke="#ffffff" stroke-width="2" stroke-linecap="round" />
                  </svg>
                </span>
                <span class="document-card__title">Dự thảo báo cáo chính trị Đại hội Đoàn XIII</span>
              </a>
            </li>
            <li class="documents__item" role="listitem">
              <a class="document-card" href="assets/documents/du-thao-bao-cao-chinh-tri-btl86-2022-2025.pdf" target="_blank" rel="noopener" data-pdf="assets/documents/du-thao-bao-cao-chinh-tri-btl86-2022-2025.pdf">
                <span class="document-card__icon" aria-hidden="true">
                  <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                    <path d="M12 6h28l12 12v40H12z" fill="#e2f1ff" stroke="#0b65c2" stroke-width="2" stroke-linejoin="round" />
                    <path d="M40 6v12h12" fill="#c5e3ff" />
                    <path d="M20 42h8l4 4 4-4h8" fill="none" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M22 30h20" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" />
                    <path d="M22 36h20" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" />
                  </svg>
                </span>
                <span class="document-card__title">Dự thảo báo cáo chính trị BTL86 giai đoạn 2022 - 2025</span>
              </a>
            </li>
            <li class="documents__item" role="listitem">
              <a class="document-card" href="assets/documents/bao-cao-chinh-tri-dai-hoi-dcs-2025-2030.pdf" target="_blank" rel="noopener" data-pdf="assets/documents/bao-cao-chinh-tri-dai-hoi-dcs-2025-2030.pdf">
                <span class="document-card__icon" aria-hidden="true">
                  <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                    <path d="M12 6h28l12 12v40H12z" fill="#e2f1ff" stroke="#0b65c2" stroke-width="2" stroke-linejoin="round" />
                    <path d="M40 6v12h12" fill="#c5e3ff" />
                    <path d="M22 30h20" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" />
                    <path d="M22 36h12" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" />
                    <path d="M22 42h20" stroke="#0b65c2" stroke-width="3" stroke-linecap="round" />
                  </svg>
                </span>
                <span class="document-card__title">Báo cáo chính trị trình Đại hội ĐCS nhiệm kỳ 2025 - 2030</span>
              </a>
            </li>
            <li class="documents__item" role="listitem">
              <a class="document-card" href="assets/documents/bao-cao-kiem-diem-ban-chap-hanh-2022-2025.pdf" target="_blank" rel="noopener" data-pdf="assets/documents/bao-cao-kiem-diem-ban-chap-hanh-2022-2025.pdf">
                <span class="document-card__icon" aria-hidden="true">
                  <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                    <path d="M12 6h28l12 12v40H12z" fill="#e2f1ff" stroke="#0b65c2" stroke-width="2" stroke-linejoin="round" />
                    <path d="M40 6v12h12" fill="#c5e3ff" />
                    <path d="M20 32h24v14H20z" fill="#0b65c2" rx="2" />
                    <path d="M24 36h16" stroke="#ffffff" stroke-width="2" stroke-linecap="round" />
                    <path d="M24 40h16" stroke="#ffffff" stroke-width="2" stroke-linecap="round" />
                  </svg>
                </span>
                <span class="document-card__title">Báo cáo kiểm điểm của Ban chấp hành ĐCS nhiệm kỳ 2022 - 2025</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <section id="feedback" class="section section--accent">
      <div class="container feedback">
        <div class="feedback__intro">
          <span class="section__eyebrow section__eyebrow--light">Đóng góp ý kiến</span>
          <h2>Chung tay xây dựng văn kiện Đại hội</h2>
          <p>
            Mọi ý kiến sẽ được tổng hợp, phân loại và phản hồi tới Ban Tổ chức. Vui lòng cung cấp họ tên cùng đơn vị công tác
            để thuận tiện cho việc liên hệ khi cần làm rõ thêm góp ý.
          </p>
        </div>
        <form class="feedback__form" id="feedbackForm" novalidate>
          <div class="feedback__group">
            <label for="feedbackName" class="feedback__label">Họ và tên</label>
            <input id="feedbackName" name="feedbackName" type="text" autocomplete="name" placeholder="Nhập họ và tên của bạn" required>
          </div>
          <div class="feedback__group">
            <label for="feedbackUnit" class="feedback__label">Đơn vị công tác</label>
            <input id="feedbackUnit" name="feedbackUnit" type="text" autocomplete="organization" placeholder="Ví dụ: Chi đoàn Kế hoạch - Tổng hợp" required>
          </div>
          <div class="feedback__group">
            <label for="feedbackContent" class="feedback__label">Ý kiến của bạn</label>
            <textarea id="feedbackContent" name="feedbackContent" rows="6" placeholder="Nhập ý kiến, kiến nghị, đề xuất của bạn..." required></textarea>
          </div>
          <p class="feedback__helper">Thông tin chỉ phục vụ công tác tổng hợp, được bảo mật và lưu trữ trong hệ thống góp ý của Đại hội.</p>
          <button type="submit" class="button button--primary">Gửi ý kiến</button>
          <p class="feedback__message" role="status" aria-live="polite"></p>
        </form>
        <div class="feedback__board" aria-live="polite">
          <h3>Ý kiến đã ghi nhận</h3>
          <ul id="feedbackList" class="feedback__list"></ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__content">
      <div class="footer__brand">
        <img src="assets/images/doan-logo.svg" alt="Logo Đoàn" class="footer__logo">
        <div>
          <p class="footer__title">Đoàn cơ sở Trung tâm 386</p>
          <p class="footer__subtitle">Đại hội nhiệm kỳ 2025 - 2030</p>
        </div>
      </div>
      <a href="#top" class="footer__backtop">Về đầu trang ↑</a>
    </div>
  </footer>

  <div class="modal" id="documentModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" hidden>
    <div class="modal__backdrop" data-close="true"></div>
    <div class="modal__content" role="document">
      <header class="modal__header">
        <h3 id="modalTitle">Trình chiếu văn kiện</h3>
        <button class="modal__close" aria-label="Đóng" data-close="true">×</button>
      </header>
      <div class="modal__body">
        <iframe id="modalViewer" title="Trình xem PDF" src="" loading="lazy"></iframe>
      </div>
    </div>
  </div>

  <script>
    (() => {
      'use strict';

      document.documentElement.classList.add('js-enabled');

      const modal = document.getElementById('documentModal');
      const modalViewer = document.getElementById('modalViewer');
      const modalCloseTargets = modal ? modal.querySelectorAll('[data-close="true"]') : [];
      const documentTriggers = document.querySelectorAll('[data-pdf]');
      const mobileQuery = window.matchMedia('(max-width: 767px)');
      const body = document.body;

      const FEEDBACK_ENDPOINT = '/api/feedbacks';
      const FEEDBACK_TEXT_SOURCE = 'ykien.txt';
      const ENTRY_START = '===YK_START===';
      const ENTRY_END = '===YK_END===';

      const isDesktopViewport = () => !mobileQuery.matches;

      const forceDownload = (pdfUrl) => {
        const link = document.createElement('a');
        link.href = pdfUrl;
        link.setAttribute('download', pdfUrl.split('/').pop() || 'document.pdf');
        link.rel = 'noopener';
        link.style.display = 'none';
        document.body.appendChild(link);
        link.click();
        link.remove();
      };

      const updateTriggerDownloadAttribute = () => {
        const useModal = isDesktopViewport();
        documentTriggers.forEach((trigger) => {
          if (useModal) {
            trigger.removeAttribute('download');
          } else {
            trigger.setAttribute('download', '');
          }
        });
      };

      const openModal = (pdfUrl) => {
        if (!modal || !modalViewer) {
          window.open(pdfUrl, '_blank');
          return;
        }

        modalViewer.src = pdfUrl;
        modal.removeAttribute('hidden');
        body.style.overflow = 'hidden';
      };

      const closeModal = () => {
        if (!modal || !modalViewer) {
          return;
        }
        modalViewer.src = '';
        modal.setAttribute('hidden', '');
        body.style.overflow = '';
      };

      documentTriggers.forEach((trigger) => {
        trigger.addEventListener('click', (event) => {
          const pdfUrl = trigger.getAttribute('data-pdf') || trigger.getAttribute('href');
          if (!pdfUrl) {
            return;
          }

          if (isDesktopViewport()) {
            if (event) {
              event.preventDefault();
            }
            openModal(pdfUrl);
            return;
          }

          if (event) {
            event.preventDefault();
          }
          forceDownload(pdfUrl);
        });
      });

      modalCloseTargets.forEach((element) => {
        element.addEventListener('click', (event) => {
          event.preventDefault();
          closeModal();
        });
      });

      window.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && modal && !modal.hasAttribute('hidden')) {
          closeModal();
        }
      });

      if (modal) {
        modal.addEventListener('click', (event) => {
          if (event.target instanceof HTMLElement && event.target.dataset.close === 'true') {
            closeModal();
          }
        });
      }

      const feedbackForm = document.getElementById('feedbackForm');
      const feedbackName = document.getElementById('feedbackName');
      const feedbackUnit = document.getElementById('feedbackUnit');
      const feedbackContent = document.getElementById('feedbackContent');
      const feedbackMessage = document.querySelector('.feedback__message');
      const feedbackList = document.getElementById('feedbackList');

      let feedbackItems = [];
      let backendAvailable = true;
      let cachedFeedbackText = '';

      const parseJsonLines = (raw) =>
        raw
          .split('\n')
          .map((line) => line.trim())
          .filter(Boolean)
          .map((line) => {
            try {
              return JSON.parse(line);
            } catch (error) {
              console.warn('Bỏ qua dòng ý kiến không hợp lệ:', line);
              return null;
            }
          })
          .filter(Boolean)
          .reverse();

      const parseFeedbackBlocks = (raw) => {
        const segments = raw.split(ENTRY_START);
        const records = [];

        segments.forEach((segment) => {
          const trimmed = segment.trim();
          if (!trimmed) {
            return;
          }

          const [content] = trimmed.split(ENTRY_END);
          if (!content) {
            return;
          }

          const lines = content
            .split('\n')
            .map((line) => line.trim())
            .filter(Boolean);

          const record = {};
          lines.forEach((line) => {
            const [key, ...rest] = line.split(':');
            if (!key || rest.length === 0) {
              return;
            }

            const value = rest.join(':').trim();

            switch (key) {
              case 'name':
                record.name = value;
                break;
              case 'unit':
                record.unit = value;
                break;
              case 'message':
                record.message = value;
                break;
              case 'recordedAt':
                record.recordedAt = value;
                break;
              case 'id':
                record.id = value;
                break;
              default:
                break;
            }
          });

          if (record.name && record.unit && record.message && record.recordedAt) {
            if (!record.id) {
              record.id = Date.now().toString(36) + Math.random().toString(36).slice(2, 8);
            }
            records.push(record);
          }
        });

        return records.reverse();
      };

      const parseFeedbackText = (raw) => {
        if (!raw || !raw.trim()) {
          return [];
        }

        if (raw.includes(ENTRY_START)) {
          return parseFeedbackBlocks(raw);
        }

        return parseJsonLines(raw);
      };

      const normalizeWhitespace = (value) => value.replace(/\s+/g, ' ').trim();

      const buildFeedbackRecord = ({ name, unit, message }) => ({
        id: Date.now().toString(36) + Math.random().toString(36).slice(2, 8),
        name: normalizeWhitespace(name),
        unit: normalizeWhitespace(unit),
        message: normalizeWhitespace(message),
        recordedAt: new Intl.DateTimeFormat('vi-VN', {
          dateStyle: 'medium',
          timeStyle: 'short'
        }).format(new Date())
      });

      const formatFeedbackBlock = (feedback) =>
        [
          ENTRY_START,
          `id: ${feedback.id}`,
          `name: ${feedback.name}`,
          `unit: ${feedback.unit}`,
          `message: ${feedback.message}`,
          `recordedAt: ${feedback.recordedAt}`,
          ENTRY_END,
          ''
        ].join('\n');

      const ensureTrailingNewline = (text) => (text.endsWith('\n') ? text : `${text}\n`);

      const downloadUpdatedFeedbackFile = (content) => {
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'ykien.txt';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
      };

      const setFeedbackMessage = (text, tone = 'info') => {
        if (!feedbackMessage) return;
        feedbackMessage.textContent = text;

        if (tone === 'error') {
          feedbackMessage.style.color = '#ffd166';
        } else if (tone === 'success') {
          feedbackMessage.style.color = '#b7f8c8';
        } else {
          feedbackMessage.style.color = '#ffffff';
        }
      };

      const showFeedbackListMessage = (text) => {
        if (!feedbackList) return;
        feedbackList.innerHTML = '';
        const messageItem = document.createElement('li');
        messageItem.textContent = text;
        messageItem.className = 'feedback__item feedback__item--empty';
        feedbackList.appendChild(messageItem);
      };

      const renderFeedbackList = () => {
        if (!feedbackList) return;
        feedbackList.innerHTML = '';

        if (!feedbackItems.length) {
          showFeedbackListMessage('Chưa có ý kiến nào. Hãy là người đầu tiên đóng góp!');
          return;
        }

        feedbackItems.forEach((item) => {
          const li = document.createElement('li');
          li.className = 'feedback__item';

          const identity = document.createElement('div');
          identity.className = 'feedback__meta';

          const nameEl = document.createElement('p');
          nameEl.className = 'feedback__identity';
          nameEl.textContent = `${item.name} · ${item.unit}`;

          const time = document.createElement('span');
          time.textContent = item.recordedAt;
          time.className = 'feedback__time';

          identity.appendChild(nameEl);
          identity.appendChild(time);

          const content = document.createElement('p');
          content.textContent = item.message;
          content.style.margin = '0';

          li.appendChild(identity);
          li.appendChild(content);
          feedbackList.appendChild(li);
        });
      };

      const disableFeedbackForm = (message) => {
        setFeedbackMessage(message, 'error');
        showFeedbackListMessage(message);
        if (!feedbackForm) return;
        feedbackForm.querySelectorAll('input, textarea, button').forEach((element) => {
          element.disabled = true;
        });
      };

      const fetchFeedbacks = async () => {
        if (!feedbackForm) return;

        showFeedbackListMessage('Đang tải ý kiến đã gửi...');

        try {
          const response = await fetch(FEEDBACK_ENDPOINT, { cache: 'no-store' });
          if (!response.ok) {
            throw new Error(`Failed to load feedbacks: ${response.status}`);
          }

          const data = await response.json();
          if (Array.isArray(data)) {
            feedbackItems = data;
          } else {
            feedbackItems = [];
          }
          backendAvailable = true;
          renderFeedbackList();
          setFeedbackMessage('Hãy chia sẻ ý kiến của bạn để Ban Tổ chức kịp thời ghi nhận.');
        } catch (error) {
          console.error(error);
          backendAvailable = false;

          try {
            const response = await fetch(`${FEEDBACK_TEXT_SOURCE}?t=${Date.now()}`, { cache: 'no-store' });
            if (!response.ok) {
              throw new Error(`Failed to load fallback feedback file: ${response.status}`);
            }

            const raw = await response.text();
            cachedFeedbackText = raw || '';
            feedbackItems = parseFeedbackText(raw);
            renderFeedbackList();
            setFeedbackMessage(
              'Phiên bản trực tuyến đang chạy ở chế độ tải tệp. Khi gửi, bạn sẽ nhận được file ykien.txt đã cập nhật.',
              'info'
            );
          } catch (fallbackError) {
            console.error(fallbackError);
            disableFeedbackForm('Không thể tải dữ liệu góp ý trong phiên bản này. Vui lòng liên hệ Ban Tổ chức để được hỗ trợ.');
          }
        }
      };

      const submitFeedbackApi = async (payload) => {
        const response = await fetch(FEEDBACK_ENDPOINT, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          const message = errorData.message || 'Không thể gửi ý kiến. Vui lòng thử lại.';
          throw new Error(message);
        }

        return response.json();
      };

      const submitFeedbackStatic = async (payload) => {
        const record = buildFeedbackRecord(payload);
        const nextText = cachedFeedbackText && cachedFeedbackText.trim()
          ? ensureTrailingNewline(cachedFeedbackText) + ensureTrailingNewline(formatFeedbackBlock(record))
          : ensureTrailingNewline(formatFeedbackBlock(record));

        cachedFeedbackText = nextText;
        downloadUpdatedFeedbackFile(nextText);
        return record;
      };

      const initFeedbackFeature = () => {
        if (!feedbackForm) {
          return;
        }

        fetchFeedbacks();

        feedbackForm.addEventListener('submit', async (event) => {
          event.preventDefault();

          const name = feedbackName.value.trim();
          const unit = feedbackUnit.value.trim();
          const message = feedbackContent.value.trim();

          if (name.length < 3) {
            setFeedbackMessage('Vui lòng nhập họ và tên (tối thiểu 3 ký tự).', 'error');
            feedbackName.focus();
            return;
          }

          if (unit.length < 3) {
            setFeedbackMessage('Vui lòng nhập tên đơn vị đầy đủ.', 'error');
            feedbackUnit.focus();
            return;
          }

          if (message.length < 10) {
            setFeedbackMessage('Vui lòng nhập ý kiến chi tiết hơn (tối thiểu 10 ký tự).', 'error');
            feedbackContent.focus();
            return;
          }

          const submitButton = feedbackForm.querySelector('button[type="submit"]');
          if (submitButton) {
            submitButton.disabled = true;
            submitButton.textContent = 'Đang gửi...';
          }

          try {
            const savedFeedback = backendAvailable
              ? await submitFeedbackApi({ name, unit, message })
              : await submitFeedbackStatic({ name, unit, message });

            feedbackItems = [savedFeedback, ...feedbackItems];
            renderFeedbackList();
            feedbackForm.reset();
            if (backendAvailable) {
              setFeedbackMessage('Cảm ơn bạn! Ý kiến đã được ghi nhận vào hệ thống.', 'success');
            } else {
              setFeedbackMessage(
                'Đã tạo file ykien.txt chứa ý kiến của bạn. Vui lòng gửi file tới Ban Tổ chức để cập nhật vào hệ thống.',
                'success'
              );
            }
          } catch (error) {
            console.error(error);
            setFeedbackMessage(error.message || 'Không thể gửi ý kiến. Vui lòng thử lại.', 'error');
          } finally {
            if (submitButton) {
              submitButton.disabled = false;
              submitButton.textContent = 'Gửi ý kiến';
            }
          }
        });
      };

      updateTriggerDownloadAttribute();
      if (typeof mobileQuery.addEventListener === 'function') {
        mobileQuery.addEventListener('change', updateTriggerDownloadAttribute);
      } else if (typeof mobileQuery.addListener === 'function') {
        mobileQuery.addListener(updateTriggerDownloadAttribute);
      }

      initFeedbackFeature();
    })();
  </script>
</body>
</html>
